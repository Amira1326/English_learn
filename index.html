<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>VocabMaster Pro | British English üá¨üáß</title>
<style>
:root{--primary:#6c5ce7;--secondary:#fab1a0;--success:#00b894;--danger:#ff7675;--bg:#f4f7f6;--card:#ffffff;--text:#2d3436}
.dark{--bg:#1a1a2e;--card:#16213e;--text:#f8f9fa;--primary:#74b9ff}

*{box-sizing:border-box; transition: 0.3s}
body{margin:0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background:var(--bg); color:var(--text); direction: ltr;}

header{background: var(--card); padding:15px 20px; display:flex; justify-content:space-between; align-items:center; box-shadow: 0 2px 10px rgba(0,0,0,0.1); position: sticky; top:0; z-index:1000}
.logo { font-weight: 800; font-size: 1.4rem; color: var(--primary); letter-spacing: -0.5px; }

.container{max-width: 850px; margin: auto; padding: 20px}

.main-card { background: var(--card); padding: 25px; border-radius: 24px; box-shadow: 0 8px 24px rgba(0,0,0,0.05); margin-bottom: 25px; }
h3 { margin-top:0; font-size: 1.1rem; border-left: 4px solid var(--primary); padding-left: 12px; margin-bottom: 20px; }

/* Category Management */
.cat-container { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 20px; }
.cat-chip { background: var(--bg); padding: 8px 16px; border-radius: 30px; font-size: 0.9rem; cursor: pointer; border: 2px solid transparent; font-weight: 600; display: flex; align-items: center; }
.cat-chip.active { background: var(--primary); color: white; box-shadow: 0 4px 12px rgba(108, 92, 231, 0.3); }
.del-cat { margin-left: 8px; font-size: 1.1rem; opacity: 0.6; }
.del-cat:hover { opacity: 1; color: var(--danger); }

/* Form Styles */
.input-grid { display: grid; grid-template-columns: 1fr; gap: 15px; }
@media(min-width: 600px) { .input-grid { grid-template-columns: 1fr 1fr; } .full { grid-column: 1 / -1; } }
input, select { width: 100%; padding: 14px; border-radius: 12px; border: 2px solid #eee; background: var(--bg); color: var(--text); font-size: 1rem; }
input:focus { border-color: var(--primary); outline: none; background: white; }

.btn { border: none; padding: 14px 24px; border-radius: 12px; font-weight: 700; cursor: pointer; transition: 0.2s; font-size: 1rem; }
.btn-p { background: var(--primary); color: white; }
.btn-p:hover { transform: translateY(-2px); filter: brightness(1.1); }

/* Table Section */
.table-wrapper { overflow-x: auto; border-radius: 15px; }
table { width: 100%; border-collapse: collapse; min-width: 500px; }
th, td { padding: 16px; text-align: left; border-bottom: 1px solid rgba(0,0,0,0.05); }
th { background: rgba(0,0,0,0.02); text-transform: uppercase; font-size: 0.75rem; letter-spacing: 1px; color: #888; }
.word-cell { font-weight: 700; color: var(--primary); display: flex; align-items: center; gap: 8px; cursor: pointer; }
.badge { background: #eee; padding: 4px 10px; border-radius: 8px; font-size: 0.8rem; font-weight: 600; }

.stats-row { display: flex; gap: 15px; margin-bottom: 25px; overflow-x: auto; padding-bottom: 10px; }
.stat-box { background: var(--card); padding: 15px 25px; border-radius: 18px; min-width: 140px; text-align: center; box-shadow: 0 4px 12px rgba(0,0,0,0.03); }
.stat-box b { font-size: 1.4rem; color: var(--primary); display: block; }
.stat-box small { font-size: 0.75rem; color: #888; text-transform: uppercase; }

</style>
</head>
<body>

<header>
    <div class="logo">VocabMaster üá¨üáß</div>
    <div style="display:flex; gap:10px">
        <button onclick="exportData()" title="Backup Data" style="background:none; border:none; cursor:pointer; font-size:1.2rem">üíæ</button>
        <button onclick="document.body.classList.toggle('dark')" title="Toggle Theme" style="background:none; border:none; cursor:pointer; font-size:1.2rem">üåì</button>
    </div>
</header>

<div class="container">

    <div class="stats-row">
        <div class="stat-box"><b id="statWords">0</b><small>Total Words</small></div>
        <div class="stat-box"><b id="statCats">0</b><small>Categories</small></div>
        <div class="stat-box"><b id="statToday">0</b><small>Added Today</small></div>
    </div>
    
    <div class="main-card">
        <h3>üìÇ Manage Categories</h3>
        <div class="cat-container" id="categoryChips"></div>
        <div class="input-grid" style="grid-template-columns: 1fr auto;">
            <input id="newCatInput" placeholder="New category name...">
            <button class="btn btn-p" onclick="addNewCategory()">Add</button>
        </div>
    </div>

    <div class="main-card">
        <h3>‚ûï Add New Vocabulary</h3>
        <div class="input-grid">
            <input id="wordInput" placeholder="English word (e.g. Resilience)">
            <input id="meanInput" placeholder="Meaning / Translation">
            <select id="catSelect" class="full"></select>
            <button class="btn btn-p full" onclick="saveWord()">Save Word</button>
        </div>
    </div>

    <div class="main-card">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px">
            <h3 id="listHeading" style="margin:0">All Collections</h3>
            <input id="searchBar" oninput="render()" placeholder="üîç Search word..." style="width: 40%; padding: 8px 15px; margin:0">
        </div>
        
        <div class="table-wrapper">
            <table>
                <thead>
                    <tr>
                        <th>Word</th>
                        <th>Meaning</th>
                        <th>Category</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody id="tableBody"></tbody>
            </table>
        </div>
    </div>

</div>

<script>
// Logic & Data
let vocabData = JSON.parse(localStorage.getItem('vocabFullEngData')) || {
    words: [],
    categories: ['General', 'Business', 'Academic']
};

let activeFilter = 'All';

function saveData() {
    localStorage.setItem('vocabFullEngData', JSON.stringify(vocabData));
    render();
}

function addNewCategory() {
    const val = newCatInput.value.trim();
    if(val && !vocabData.categories.includes(val)) {
        vocabData.categories.push(val);
        newCatInput.value = '';
        saveData();
    }
}

function deleteCategory(catName, e) {
    e.stopPropagation();
    if(confirm(`Delete category "${catName}"? Words will stay but categories will be reset.`)) {
        vocabData.categories = vocabData.categories.filter(c => c !== catName);
        if(activeFilter === catName) activeFilter = 'All';
        saveData();
    }
}

function saveWord() {
    const w = wordInput.value.trim();
    const m = meanInput.value.trim();
    const c = catSelect.value;
    if(!w || !m) return alert("Please fill both word and meaning!");

    vocabData.words.unshift({ 
        id: Date.now(), 
        w, 
        m, 
        c,
        date: new Date().toLocaleDateString()
    });
    
    wordInput.value = ''; meanInput.value = '';
    saveData();
}

function deleteWord(id) {
    if(confirm('Delete this word?')) {
        vocabData.words = vocabData.words.filter(w => w.id !== id);
        saveData();
    }
}

// British English Pronunciation
function speak(txt) {
    window.speechSynthesis.cancel();
    const msg = new SpeechSynthesisUtterance(txt);
    const voices = window.speechSynthesis.getVoices();
    // Try to find UK English specifically
    msg.voice = voices.find(v => v.lang === 'en-GB' || v.lang.includes('GB')) || voices[0];
    msg.lang = 'en-GB';
    msg.rate = 0.85; 
    window.speechSynthesis.speak(msg);
}

function render() {
    // Stats Update
    const today = new Date().toLocaleDateString();
    document.getElementById('statWords').innerText = vocabData.words.length;
    document.getElementById('statCats').innerText = vocabData.categories.length;
    document.getElementById('statToday').innerText = vocabData.words.filter(w => w.date === today).length;

    // Categories Chips
    const chipsHtml = `<span class="cat-chip ${activeFilter === 'All' ? 'active' : ''}" onclick="filterBy('All')">All</span>` +
        vocabData.categories.map(c => `
            <span class="cat-chip ${activeFilter === c ? 'active' : ''}" onclick="filterBy('${c}')">
                ${c} <span class="del-cat" onclick="deleteCategory('${c}', event)">√ó</span>
            </span>
        `).join('');
    categoryChips.innerHTML = chipsHtml;

    // Dropdown Select
    catSelect.innerHTML = vocabData.categories.map(c => `<option value="${c}">${c}</option>`).join('');

    // Table Logic
    let filtered = vocabData.words;
    if(activeFilter !== 'All') {
        filtered = filtered.filter(w => w.c === activeFilter);
    }
    const search = searchBar.value.toLowerCase();
    filtered = filtered.filter(w => w.w.toLowerCase().includes(search) || w.m.toLowerCase().includes(search));

    tableBody.innerHTML = filtered.map(w => `
        <tr>
            <td class="word-cell" onclick="speak('${w.w}')">üîä ${w.w}</td>
            <td>${w.m}</td>
            <td><span class="badge">${w.c}</span></td>
            <td><button onclick="deleteWord(${w.id})" style="background:none; border:none; cursor:pointer; font-size:1.1rem">üóëÔ∏è</button></td>
        </tr>
    `).join('');

    listHeading.innerText = activeFilter === 'All' ? 'All Collections' : `Category: ${activeFilter}`;
}

function filterBy(cat) {
    activeFilter = cat;
    render();
}

function exportData() {
    const blob = new Blob([JSON.stringify(vocabData)], {type:'application/json'});
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = `vocab_backup_${new Date().toLocaleDateString()}.json`;
    a.click();
}

// Initialize
render();
// Chrome needs this to load voices correctly
window.speechSynthesis.onvoiceschanged = render;
</script>
</body>
</html>
