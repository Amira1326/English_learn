<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>VocabMaster Ultra üá¨üáß</title>
<style>
:root{--primary:#6c5ce7;--secondary:#a29bfe;--success:#00b894;--danger:#ff7675;--bg:#f8f9fa;--card:#ffffff;--text:#2d3436}
.dark{--bg:#1a1a2e;--card:#16213e;--text:#f8f9fa;--primary:#74b9ff}

*{box-sizing:border-box; transition: 0.3s}
body{margin:0; font-family: 'Inter', system-ui, sans-serif; background:var(--bg); color:var(--text); direction: ltr;}

header{background: var(--card); padding:15px 20px; display:flex; justify-content:space-between; align-items:center; box-shadow: 0 2px 10px rgba(0,0,0,0.1); position: sticky; top:0; z-index:1000}
.container{max-width: 800px; margin: auto; padding: 20px}

/* Tabs System */
.tabs{display: flex; gap: 10px; margin-bottom: 20px; overflow-x: auto; padding-bottom: 5px; -webkit-overflow-scrolling: touch;}
.tab-btn{padding: 10px 20px; background: var(--card); border-radius: 12px; cursor: pointer; border: 2px solid transparent; font-weight: bold; white-space: nowrap; flex-shrink: 0;}
.tab-btn.active{border-color: var(--primary); color: var(--primary); box-shadow: 0 4px 10px rgba(108, 92, 231, 0.2);}

.section{display: none;}
.section.active{display: block; animation: fadeIn 0.4s ease;}
@keyframes fadeIn{from{opacity:0; transform:translateY(10px)} to{opacity:1; transform:translateY(0)}}

.main-card { background: var(--card); padding: 25px; border-radius: 24px; box-shadow: 0 8px 24px rgba(0,0,0,0.05); margin-bottom: 25px; text-align: center;}

/* Flashcard Styles */
.flip-container { width: 100%; max-width: 320px; height: 200px; margin: 20px auto; perspective: 1000px; cursor: pointer;}
.flipper { position: relative; width: 100%; height: 100%; transition: 0.6s; transform-style: preserve-3d; }
.flipper.flipped { transform: rotateY(180deg); }
.front, .back { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 20px; display: flex; align-items: center; justify-content: center; padding: 20px; font-size: 1.5rem; font-weight: bold; color: white; box-shadow: 0 8px 15px rgba(0,0,0,0.1); }
.front { background: var(--primary); }
.back { background: var(--success); transform: rotateY(180deg); }

/* Quiz Styles */
.quiz-option { padding: 15px; background: var(--bg); border: 2px solid #eee; border-radius: 12px; margin-top: 10px; cursor: pointer; font-weight: 500;}
.quiz-option:hover { border-color: var(--primary); }
.quiz-option.correct { background: var(--success) !important; color: white; border-color: var(--success); }
.quiz-option.wrong { background: var(--danger) !important; color: white; border-color: var(--danger); }

/* Inputs & UI Elements */
.input-grid { display: grid; grid-template-columns: 1fr; gap: 10px; text-align: left;}
@media(min-width: 600px) { .input-grid { grid-template-columns: 1fr 1fr; } .full { grid-column: 1 / -1; } }
input, select { padding: 12px; border-radius: 10px; border: 1px solid #ddd; background: var(--bg); color: var(--text); font-size: 1rem; }
.btn { border: none; padding: 12px 24px; border-radius: 12px; font-weight: bold; cursor: pointer; background: var(--primary); color: white; }
.btn-s { background: #eee; color: #333; }

/* Filter Bar */
.filter-bar { display: flex; gap: 10px; margin-bottom: 15px; align-items: center; flex-wrap: wrap; }

/* Table */
.scroll-x { overflow-x: auto; border-radius: 15px; border: 1px solid #eee; }
table { width: 100%; border-collapse: collapse; min-width: 500px; }
th, td { padding: 14px; text-align: left; border-bottom: 1px solid #eee; }
th { background: #fbfbfb; color: #888; font-size: 0.8rem; text-transform: uppercase; }
.badge { background: var(--secondary); color: white; padding: 4px 8px; border-radius: 6px; font-size: 0.7rem; }
</style>
</head>
<body>

<header>
    <div style="font-weight: 800; font-size: 1.4rem; color: var(--primary);">VocabMaster üá¨üáß</div>
    <div style="display:flex; gap:10px">
        <button onclick="exportData()" style="background:none; border:none; cursor:pointer;">üíæ</button>
        <button onclick="document.body.classList.toggle('dark')" style="background:none; border:none; cursor:pointer; font-size:1.2rem">üåì</button>
    </div>
</header>

<div class="container">
    <div class="tabs" id="tabBar">
        <div class="tab-btn active" onclick="showTab(event, 'learn')">üìñ Learn</div>
        <div class="tab-btn" onclick="showTab(event, 'quiz')">üß† Quiz</div>
        <div class="tab-btn" onclick="showTab(event, 'manage')">‚ûï Add Word</div>
        <div class="tab-btn" onclick="showTab(event, 'list')">üìö Dictionary</div>
    </div>

    <div id="learn" class="section active">
        <div class="main-card">
            <h3>Flashcards</h3>
            <div class="flip-container" onclick="this.querySelector('.flipper').classList.toggle('flipped')">
                <div class="flipper" id="flipper">
                    <div class="front" id="flash-front">Empty List</div>
                    <div class="back" id="flash-back">Add words to start</div>
                </div>
            </div>
            <div style="display:flex; gap:10px; justify-content:center">
                <button class="btn btn-s" onclick="prevCard()">‚¨ÖÔ∏è Prev</button>
                <button class="btn btn-s" onclick="speakFlash()">üîä Listen</button>
                <button class="btn" onclick="nextCard()">Next ‚û°Ô∏è</button>
            </div>
        </div>
    </div>

    <div id="quiz" class="section">
        <div class="main-card">
            <h3>Vocabulary Quiz</h3>
            <p id="quiz-q" style="font-size: 1.2rem; font-weight: bold;">Add words to unlock the quiz!</p>
            <div id="quiz-options"></div>
            <button class="btn" id="quiz-start" onclick="startQuiz()" style="margin-top:15px">Start Quiz</button>
        </div>
    </div>

    <div id="manage" class="section">
        <div class="main-card">
            <h3 style="text-align: left;">‚ûï Add New Word</h3>
            <div class="input-grid">
                <input id="wIn" placeholder="English Word">
                <input id="mIn" placeholder="Meaning / Translation">
                <select id="cIn" class="full"></select>
                <button class="btn full" onclick="saveWord()">Save to Dictionary</button>
            </div>
            <hr style="margin:30px 0; opacity:0.1">
            <h3 style="text-align: left;">üìÅ Create New Category</h3>
            <div class="input-grid" style="grid-template-columns: 1fr auto;">
                <input id="newCat" placeholder="Category Name (e.g. Work)">
                <button class="btn" onclick="addCat()">Add Category</button>
            </div>
        </div>
    </div>

    <div id="list" class="section">
        <div class="main-card">
            <h3 style="text-align: left;">Your Dictionary</h3>
            <div class="filter-bar">
                <select id="filterCat" onchange="render()" style="flex: 1;">
                    <option value="All">All Categories</option>
                </select>
                <input id="search" oninput="render()" placeholder="Search word..." style="flex: 2;">
            </div>
            <div class="scroll-x">
                <table id="vocabTable">
                    <thead>
                        <tr>
                            <th>Word</th>
                            <th>Meaning</th>
                            <th>Category</th>
                            <th>Del</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody"></tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<script>
let data = JSON.parse(localStorage.getItem('vocabFilterData')) || {
    words: [],
    categories: ['General', 'Travel', 'Work']
};

let curIdx = 0;

// --- Tab Navigation ---
function showTab(event, tabId) {
    document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
    document.getElementById(tabId).classList.add('active');
    event.currentTarget.classList.add('active');
    if(tabId === 'learn') updateFlashcard();
}

// --- Data Management ---
function saveWord() {
    const w = wIn.value.trim(), m = mIn.value.trim(), c = cIn.value;
    if(!w || !m) return alert("Please fill in both the word and the meaning.");
    data.words.unshift({ id: Date.now(), w, m, c });
    wIn.value = ''; mIn.value = '';
    save();
}

function addCat() {
    const c = newCat.value.trim();
    if(c && !data.categories.includes(c)) {
        data.categories.push(c);
        newCat.value = '';
        save();
    }
}

function deleteWord(id) {
    if(confirm("Delete this word?")) {
        data.words = data.words.filter(w => w.id !== id);
        save();
    }
}

function save() {
    localStorage.setItem('vocabFilterData', JSON.stringify(data));
    render();
}

// --- British Pronunciation ---
function speak(txt) {
    window.speechSynthesis.cancel();
    const msg = new SpeechSynthesisUtterance(txt);
    msg.voice = window.speechSynthesis.getVoices().find(v => v.lang === 'en-GB' || v.lang.includes('GB')) || null;
    msg.lang = 'en-GB';
    msg.rate = 0.85;
    window.speechSynthesis.speak(msg);
}

// --- Flashcards ---
function updateFlashcard() {
    if(data.words.length === 0) return;
    document.getElementById('flipper').classList.remove('flipped');
    document.getElementById('flash-front').innerText = data.words[curIdx].w;
    document.getElementById('flash-back').innerText = data.words[curIdx].m;
}

function nextCard() {
    if(data.words.length === 0) return;
    curIdx = (curIdx + 1) % data.words.length;
    updateFlashcard();
    setTimeout(speakFlash, 300);
}

function prevCard() {
    if(data.words.length === 0) return;
    curIdx = (curIdx - 1 + data.words.length) % data.words.length;
    updateFlashcard();
    setTimeout(speakFlash, 300);
}

function speakFlash() { if(data.words[curIdx]) speak(data.words[curIdx].w); }

// --- Quiz Logic ---
function startQuiz() {
    if(data.words.length < 4) return alert("You need at least 4 words to start a quiz!");
    document.getElementById('quiz-start').style.display = 'none';
    loadQuestion();
}

function loadQuestion() {
    const optionsDiv = document.getElementById('quiz-options');
    optionsDiv.innerHTML = '';
    const qWord = data.words[Math.floor(Math.random() * data.words.length)];
    document.getElementById('quiz-q').innerText = `What does "${qWord.w}" mean?`;
    speak(qWord.w);

    let choices = [qWord.m];
    while(choices.length < 4) {
        let r = data.words[Math.floor(Math.random() * data.words.length)].m;
        if(!choices.includes(r)) choices.push(r);
    }
    choices.sort(() => Math.random() - 0.5);

    choices.forEach(c => {
        const d = document.createElement('div');
        d.className = 'quiz-option';
        d.innerText = c;
        d.onclick = () => {
            document.querySelectorAll('.quiz-option').forEach(el => el.onclick = null);
            if(c === qWord.m) {
                d.classList.add('correct');
                setTimeout(loadQuestion, 1200);
            } else {
                d.classList.add('wrong');
                setTimeout(loadQuestion, 1500);
            }
        };
        optionsDiv.appendChild(d);
    });
}

// --- Render Page ---
function render() {
    // Dropdowns
    const catOptions = data.categories.map(c => `<option value="${c}">${c}</option>`).join('');
    cIn.innerHTML = catOptions;
    filterCat.innerHTML = `<option value="All">All Categories</option>` + catOptions;

    // Filter Logic
    const activeCat = filterCat.value;
    const searchTerm = search.value.toLowerCase();
    
    let filtered = data.words;
    if(activeCat !== 'All') {
        filtered = filtered.filter(w => w.c === activeCat);
    }
    filtered = filtered.filter(w => w.w.toLowerCase().includes(searchTerm) || w.m.toLowerCase().includes(searchTerm));

    // Table Content
    tableBody.innerHTML = filtered.map(w => `
        <tr>
            <td onclick="speak('${w.w}')" style="cursor:pointer">üîä <b>${w.w}</b></td>
            <td>${w.m}</td>
            <td><span class="badge">${w.c}</span></td>
            <td><button onclick="deleteWord(${w.id})" style="background:none; border:none; cursor:pointer;">üóëÔ∏è</button></td>
        </tr>
    `).join('');

    if(data.words.length > 0) updateFlashcard();
}

function exportData() {
    const blob = new Blob([JSON.stringify(data)], {type:'application/json'});
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = 'my_vocabulary.json';
    a.click();
}

// Initial Load
window.speechSynthesis.onvoiceschanged = render;
render();
</script>
</body>
</html>
