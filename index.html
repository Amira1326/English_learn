<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>VocabMaster Ultra üá¨üáß</title>
<style>
:root{--primary:#6c5ce7;--secondary:#a29bfe;--success:#00b894;--danger:#ff7675;--bg:#f8f9fa;--card:#ffffff;--text:#2d3436}
.dark{--bg:#1a1a2e;--card:#16213e;--text:#f8f9fa;--primary:#74b9ff}

*{box-sizing:border-box; transition: 0.3s}
body{margin:0; font-family: 'Inter', system-ui, sans-serif; background:var(--bg); color:var(--text); direction: ltr;}

header{background: var(--card); padding:15px 20px; display:flex; justify-content:space-between; align-items:center; box-shadow: 0 2px 10px rgba(0,0,0,0.1); position: sticky; top:0; z-index:1000}
.container{max-width: 800px; margin: auto; padding: 20px}

/* Tabs System */
.tabs{display: flex; gap: 10px; margin-bottom: 20px; overflow-x: auto; padding-bottom: 5px;}
.tab-btn{padding: 10px 20px; background: var(--card); border-radius: 12px; cursor: pointer; border: 2px solid transparent; font-weight: bold; white-space: nowrap;}
.tab-btn.active{border-color: var(--primary); color: var(--primary);}

.section{display: none;}
.section.active{display: block; animation: fadeIn 0.4s ease;}
@keyframes fadeIn{from{opacity:0; transform:translateY(10px)} to{opacity:1; transform:translateY(0)}}

.main-card { background: var(--card); padding: 25px; border-radius: 24px; box-shadow: 0 8px 24px rgba(0,0,0,0.05); margin-bottom: 25px; text-align: center;}

/* Flashcard */
.flip-container { width: 100%; max-width: 320px; height: 200px; margin: 20px auto; perspective: 1000px; cursor: pointer;}
.flipper { position: relative; width: 100%; height: 100%; transition: 0.6s; transform-style: preserve-3d; }
.flipper.flipped { transform: rotateY(180deg); }
.front, .back { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 20px; display: flex; align-items: center; justify-content: center; padding: 20px; font-size: 1.5rem; font-weight: bold; color: white; box-shadow: 0 8px 15px rgba(0,0,0,0.1); }
.front { background: var(--primary); }
.back { background: var(--success); transform: rotateY(180deg); }

/* Quiz */
.quiz-option { padding: 15px; background: var(--bg); border: 2px solid #eee; border-radius: 12px; margin-top: 10px; cursor: pointer; font-weight: 500;}
.quiz-option.correct { background: var(--success) !important; color: white; border-color: var(--success); }
.quiz-option.wrong { background: var(--danger) !important; color: white; border-color: var(--danger); }

/* Inputs & Tables */
.input-grid { display: grid; grid-template-columns: 1fr; gap: 10px; text-align: left;}
@media(min-width: 600px) { .input-grid { grid-template-columns: 1fr 1fr; } .full { grid-column: 1 / -1; } }
input, select { padding: 12px; border-radius: 10px; border: 1px solid #ddd; background: var(--bg); color: var(--text); }
.btn { border: none; padding: 12px 24px; border-radius: 12px; font-weight: bold; cursor: pointer; background: var(--primary); color: white; }
table { width: 100%; border-collapse: collapse; margin-top: 10px; }
th, td { padding: 12px; text-align: left; border-bottom: 1px solid #eee; }
.badge { background: #eee; padding: 4px 8px; border-radius: 6px; font-size: 0.7rem; }
</style>
</head>
<body>

<header>
    <div style="font-weight: 800; font-size: 1.4rem; color: var(--primary);">VocabMaster üá¨üáß</div>
    <button onclick="document.body.classList.toggle('dark')" style="background:none; border:none; cursor:pointer; font-size:1.2rem">üåì</button>
</header>

<div class="container">
    <div class="tabs">
        <div class="tab-btn active" onclick="showTab('learn')">üìñ Learn</div>
        <div class="tab-btn" onclick="showTab('quiz')">üß† Quiz</div>
        <div class="tab-btn" onclick="showTab('manage')">‚ûï Add Word</div>
        <div class="tab-btn" onclick="showTab('list')">üìö Dictionary</div>
    </div>

    <div id="learn" class="section active">
        <div class="main-card">
            <h3>Flashcards</h3>
            <div class="flip-container" onclick="this.querySelector('.flipper').classList.toggle('flipped')">
                <div class="flipper" id="flipper">
                    <div class="front" id="flash-front">No Words Added</div>
                    <div class="back" id="flash-back">Add words to start</div>
                </div>
            </div>
            <div style="display:flex; gap:10px; justify-content:center">
                <button class="btn" onclick="nextCard()">Next Word ‚û°Ô∏è</button>
                <button class="btn" style="background:var(--success)" onclick="speakFlash()">üîä Listen</button>
            </div>
        </div>
    </div>

    <div id="quiz" class="section">
        <div class="main-card">
            <h3>Word Quiz</h3>
            <p id="quiz-q">Press Start to Begin</p>
            <div id="quiz-options"></div>
            <button class="btn" id="quiz-start" onclick="startQuiz()" style="margin-top:15px">Start Quiz</button>
        </div>
    </div>

    <div id="manage" class="section">
        <div class="main-card">
            <h3>Add New Word</h3>
            <div class="input-grid">
                <input id="wIn" placeholder="English Word">
                <input id="mIn" placeholder="Meaning">
                <select id="cIn" class="full"></select>
                <button class="btn full" onclick="saveWord()">Save Word</button>
            </div>
            <hr style="margin:20px 0; opacity:0.1">
            <h3>Manage Categories</h3>
            <div class="input-grid" style="grid-template-columns: 1fr auto;">
                <input id="newCat" placeholder="New category name">
                <button class="btn" onclick="addCat()">Add</button>
            </div>
        </div>
    </div>

    <div id="list" class="section">
        <div class="main-card">
            <div style="display:flex; gap:10px; margin-bottom:15px">
                <input id="search" oninput="render()" placeholder="Search..." style="flex:1">
            </div>
            <div style="overflow-x: auto;">
                <table id="vocabTable"></table>
            </div>
        </div>
    </div>
</div>

<script>
let data = JSON.parse(localStorage.getItem('vocabFinalData')) || {
    words: [],
    categories: ['General', 'Travel', 'Work']
};

let curIdx = 0;

// --- Core Logic ---
function showTab(tabId) {
    document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
    document.getElementById(tabId).classList.add('active');
    event.target.classList.add('active');
    if(tabId === 'learn') updateFlashcard();
}

function saveWord() {
    const w = wIn.value.trim(), m = mIn.value.trim(), c = cIn.value;
    if(!w || !m) return alert("Fill all fields");
    data.words.unshift({ id: Date.now(), w, m, c });
    wIn.value = ''; mIn.value = '';
    save();
}

function addCat() {
    const c = newCat.value.trim();
    if(c && !data.categories.includes(c)) {
        data.categories.push(c);
        newCat.value = '';
        save();
    }
}

function save() {
    localStorage.setItem('vocabFinalData', JSON.stringify(data));
    render();
}

// --- Flashcard & Audio ---
function speak(txt) {
    window.speechSynthesis.cancel();
    const msg = new SpeechSynthesisUtterance(txt);
    msg.lang = 'en-GB';
    msg.rate = 0.85;
    window.speechSynthesis.speak(msg);
}

function updateFlashcard() {
    if(data.words.length === 0) return;
    document.getElementById('flipper').classList.remove('flipped');
    document.getElementById('flash-front').innerText = data.words[curIdx].w;
    document.getElementById('flash-back').innerText = data.words[curIdx].m;
}

function nextCard() {
    if(data.words.length === 0) return;
    curIdx = (curIdx + 1) % data.words.length;
    updateFlashcard();
    setTimeout(speakFlash, 300);
}

function speakFlash() { if(data.words[curIdx]) speak(data.words[curIdx].w); }

// --- Quiz Logic ---
function startQuiz() {
    if(data.words.length < 4) return alert("Add at least 4 words!");
    document.getElementById('quiz-start').style.display = 'none';
    loadQuestion();
}

function loadQuestion() {
    const optionsDiv = document.getElementById('quiz-options');
    optionsDiv.innerHTML = '';
    const qWord = data.words[Math.floor(Math.random() * data.words.length)];
    document.getElementById('quiz-q').innerText = `What is the meaning of "${qWord.w}"?`;
    speak(qWord.w);

    let choices = [qWord.m];
    while(choices.length < 4) {
        let r = data.words[Math.floor(Math.random() * data.words.length)].m;
        if(!choices.includes(r)) choices.push(r);
    }
    choices.sort(() => Math.random() - 0.5);

    choices.forEach(c => {
        const d = document.createElement('div');
        d.className = 'quiz-option';
        d.innerText = c;
        d.onclick = () => {
            document.querySelectorAll('.quiz-option').forEach(el => el.onclick = null);
            if(c === qWord.m) d.classList.add('correct');
            else d.classList.add('wrong');
            setTimeout(loadQuestion, 1500);
        };
        optionsDiv.appendChild(d);
    });
}

function render() {
    cIn.innerHTML = data.categories.map(c => `<option>${c}</option>`).join('');
    const s = search.value.toLowerCase();
    const filtered = data.words.filter(w => w.w.toLowerCase().includes(s));
    
    vocabTable.innerHTML = `<tr><th>Word</th><th>Meaning</th><th>Cat</th></tr>` +
    filtered.map(w => `
        <tr>
            <td onclick="speak('${w.w}')" style="cursor:pointer">üîä <b>${w.w}</b></td>
            <td>${w.m}</td>
            <td><span class="badge">${w.c}</span></td>
        </tr>
    `).join('');
    
    if(data.words.length > 0) updateFlashcard();
}

render();
</script>
</body>
</html>
